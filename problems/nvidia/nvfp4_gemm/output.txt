python3 test_correctness.py
================================================================================
NVFP4 GEMM Correctness Validation
================================================================================

Running 10 test cases...
Tolerance: rtol=1e-03, atol=1e-03


[Test 1/10] M=128, N=256, K=256, L=1
------------------------------------------------------------
  Generating input data...
  Running custom kernel...
  Validating against reference...
  ✗ FAILED: mismatch found! custom implementation doesn't match reference: Number of mismatched elements: 30703 ERROR AT (0, 8, 0): -469.0 -295.25 ERROR AT (0, 9, 0): -567.0 -481.75 ERROR AT (0, 10, 0): -260.25 163.5 ERROR AT (0, 11, 0): 619.5 362.0 ERROR AT (0, 12, 0): -498.25 -243.25 ... and 30698 more mismatched elements.

[Test 2/10] M=128, N=1536, K=7168, L=1
------------------------------------------------------------
  Generating input data...
  Running custom kernel...
  Validating against reference...
  ✗ FAILED: mismatch found! custom implementation doesn't match reference: Number of mismatched elements: 184208 ERROR AT (0, 8, 0): -1836.0 -1685.0 ERROR AT (0, 9, 0): -200.5 -1172.0 ERROR AT (0, 10, 0): -935.0 -78.0 ERROR AT (0, 11, 0): 3836.0 2172.0 ERROR AT (0, 12, 0): -321.5 -3366.0 ... and 184203 more mismatched elements.

[Test 3/10] M=128, N=3072, K=1536, L=1
------------------------------------------------------------
  Generating input data...
  Running custom kernel...
  Validating against reference...
  ✗ FAILED: mismatch found! custom implementation doesn't match reference: Number of mismatched elements: 368410 ERROR AT (0, 8, 0): 1654.0 415.25 ERROR AT (0, 9, 0): 405.0 -39.75 ERROR AT (0, 10, 0): -827.0 -86.75 ERROR AT (0, 11, 0): -1158.0 -1827.0 ERROR AT (0, 12, 0): -122.75 476.5 ... and 368405 more mismatched elements.

[Test 4/10] M=256, N=7168, K=256, L=1
------------------------------------------------------------
  Generating input data...
  Running custom kernel...
  Validating against reference...
  ✗ FAILED: mismatch found! custom implementation doesn't match reference: Number of mismatched elements: 1719243 ERROR AT (0, 8, 0): -87.75 -291.5 ERROR AT (0, 9, 0): -367.75 -329.0 ERROR AT (0, 10, 0): 580.0 380.25 ERROR AT (0, 11, 0): 746.0 180.25 ERROR AT (0, 12, 0): -556.0 535.5 ... and 1719238 more mismatched elements.

[Test 5/10] M=256, N=7168, K=2048, L=1
------------------------------------------------------------
  Generating input data...
  Running custom kernel...
  Validating against reference...
  ✗ FAILED: mismatch found! custom implementation doesn't match reference: Number of mismatched elements: 1719285 ERROR AT (0, 8, 0): 2528.0 1438.0 ERROR AT (0, 9, 0): -484.25 424.5 ERROR AT (0, 10, 0): 2001.0 512.0 ERROR AT (0, 11, 0): 2136.0 1710.0 ERROR AT (0, 12, 0): 1172.0 1529.0 ... and 1719280 more mismatched elements.

[Test 6/10] M=2304, N=4608, K=7168, L=1
------------------------------------------------------------
  Generating input data...
  Running custom kernel...
  Validating against reference...
  ✗ FAILED: mismatch found! custom implementation doesn't match reference: Number of mismatched elements: 9947274 ERROR AT (0, 8, 0): -5036.0 34.5 ERROR AT (0, 9, 0): -643.0 1428.0 ERROR AT (0, 10, 0): 1939.0 453.0 ERROR AT (0, 11, 0): 2240.0 -2844.0 ERROR AT (0, 12, 0): -4780.0 -2454.0 ... and 9947269 more mismatched elements.

[Test 7/10] M=384, N=7168, K=2304, L=1
------------------------------------------------------------
  Generating input data...
  Running custom kernel...
  Validating against reference...
  ✗ FAILED: mismatch found! custom implementation doesn't match reference: Number of mismatched elements: 2578862 ERROR AT (0, 8, 0): 1330.0 691.0 ERROR AT (0, 9, 0): 569.0 723.5 ERROR AT (0, 10, 0): 2394.0 1040.0 ERROR AT (0, 11, 0): 1278.0 2270.0 ERROR AT (0, 12, 0): -2666.0 -2348.0 ... and 2578857 more mismatched elements.

[Test 8/10] M=512, N=512, K=7168, L=1
------------------------------------------------------------
  Generating input data...
  Running custom kernel...
  Validating against reference...
  ✗ FAILED: mismatch found! custom implementation doesn't match reference: Number of mismatched elements: 245594 ERROR AT (0, 8, 0): -590.0 -2980.0 ERROR AT (0, 9, 0): -3530.0 2056.0 ERROR AT (0, 10, 0): -5088.0 -3662.0 ERROR AT (0, 11, 0): 1210.0 373.25 ERROR AT (0, 12, 0): -594.0 -4192.0 ... and 245589 more mismatched elements.

[Test 9/10] M=512, N=4096, K=512, L=1
------------------------------------------------------------
  Generating input data...
  Running custom kernel...
  Validating against reference...
  ✗ FAILED: mismatch found! custom implementation doesn't match reference: Number of mismatched elements: 1964895 ERROR AT (0, 8, 0): 716.0 1992.0 ERROR AT (0, 9, 0): 142.25 -59.75 ERROR AT (0, 10, 0): -472.75 331.25 ERROR AT (0, 11, 0): -957.0 -163.5 ERROR AT (0, 12, 0): 957.0 27.25 ... and 1964890 more mismatched elements.

[Test 10/10] M=512, N=1536, K=7168, L=1
------------------------------------------------------------
  Generating input data...
  Running custom kernel...
  Validating against reference...
  ✗ FAILED: mismatch found! custom implementation doesn't match reference: Number of mismatched elements: 736869 ERROR AT (0, 8, 0): -2942.0 -3458.0 ERROR AT (0, 9, 0): 74.25 1288.0 ERROR AT (0, 10, 0): -205.0 -4644.0 ERROR AT (0, 11, 0): -4116.0 -553.5 ERROR AT (0, 12, 0): -4300.0 -2326.0 ... and 736864 more mismatched elements.

================================================================================
SUMMARY
================================================================================
Total tests: 10
Passed:      0 (0%)
Failed:      10 (100%)

✗ 10 test(s) failed