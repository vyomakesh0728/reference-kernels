

<<<CURRENT GEM OUTPUT>>>
Benchmarks:
k: 16384; l: 1; m: 7168; seed: 1111
 ‚è± 1141 ¬± 6.7 ¬µs
 ‚ö° 1129 ¬µs üêå 2.48 ms

k: 7168; l: 8; m: 4096; seed: 1111
 ‚è± 657 ¬± 0.7 ¬µs
 ‚ö° 653 ¬µs üêå 683 ¬µs

k: 2048; l: 4; m: 7168; seed: 1111
 ‚è± 212 ¬± 0.2 ¬µs
 ‚ö° 210 ¬µs üêå 224 ¬µs
Cluster Bot
APP
 ‚Äî 6:44 PM
Program stdout (1/9):
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
[1/2] /usr/local/cuda-13.0/bin/nvcc --generate-dependencies-with-compile --dependency-output cuda.cuda.o.d -DTORCH_EXTENSION_NAME=nvfp4_gemv_sm100_ptx -DTORCH_API_INCLUDE_EXTENSION_H -isystem /usr/local/lib/python3.10/dist-packages/torch/include -isystem /usr/local/lib/python3.10/dist-packages/torch/include/torch/csrc/api/include -isystem /usr/local/cuda-13.0/include -isystem /usr/include/python3.10 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -gencode=arch=compute_100a,code=sm_100a --expt-relaxed-constexpr --expt-extended-lambda -Xcudafe --diag_suppress=20012 -maxrregcount=128 --ptxas-options=-v,-warn-lmem-usage -lineinfo -DNDEBUG -I/usr/local/cutlass/include -c /home/runner/.cache/torch_extensions/py310_cu130/nvfp4_gemv_sm100_ptx/cuda.cu -o cuda.cuda.o
/home/runner/.cache/torch_extensions/py310_cu130/nvfp4_gemv_sm100_ptx/cuda.cu(617): warning #177-D: variable "K_scales" was declared but never referenced
      const uint64_t K_scales = static_cast<uint64_t>(K / 16);
                     ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

/home/runner/.cache/torch_extensions/py310_cu130/nvfp4_gemv_sm100_ptx/cuda.cu(619): warning #177-D: variable "use_tma_a" was declared but never referenced
      bool use_tma_a = true;
           ^

/home/runner/.cache/torch_extensions/py310_cu130/nvfp4_gemv_sm100_ptx/cuda.cu(201): warning #177-D: variable "mbar_b" was declared but never referenced
      uint64_t* mbar_b = reinterpret_cast<uint64_t*>(smem + offset);
                ^
Program stdout (2/9):
/home/runner/.cache/torch_extensions/py310_cu130/nvfp4_gemv_sm100_ptx/cuda.cu(204): warning #177-D: variable "mbar_sfb" was declared but never referenced
      uint64_t* mbar_sfb = reinterpret_cast<uint64_t*>(smem + offset);
                ^

ptxas warning : Local memory used for function '_Z18fp4_gemv_streamingILi128ELi128ELi320EEvPKhS1_S1_S1_PK14CUtensorMap_stS4_S4_P6__halfiii', size of stack frame: 48 bytes
ptxas info    : 28 bytes gmem
ptxas info    : Compiling entry function '_Z18fp4_gemv_streamingILi128ELi128ELi320EEvPKhS1_S1_S1_PK14CUtensorMap_stS4_S4_P6__halfiii' for 'sm_100a'
ptxas info    : Function properties for _Z18fp4_gemv_streamingILi128ELi128ELi320EEvPKhS1_S1_S1_PK14CUtensorMap_stS4_S4_P6__halfiii
    48 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 32 registers, used 1 barriers, 48 bytes cumulative stack size, 16 bytes smem
ptxas info    : Compile time = 52.872 ms
[2/2] c++ main.o cuda.cuda.o -shared -lcuda -L/usr/local/lib/python3.10/dist-packages/torch/lib -lc10 -lc10_cuda -ltorch_cpu -ltorch_cuda -ltorch -ltorch_python -L/usr/local/cuda-13.0/lib64 -lcudart -o nvfp4_gemv_sm100_ptx.so
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x555562187000
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534e00
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534340
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534e00
TMA Debug: Using RANK=2 for L=1
Program stdout (3/9):
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534340
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534e00
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534340
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534e00
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534340
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534e00
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534340
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534e00
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534340
Program stdout (4/9):
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534e00
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534340
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534e00
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534340
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534e00
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534340
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534e00
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534340
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
Program stdout (5/9):
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534e00
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534340
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534e00
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534340
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534e00
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534340
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534e00
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534340
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534e00
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
Program stdout (6/9):
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534340
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534e00
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc76000000, map_A_ptr = 0x55556a534340
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffcac000000, map_A_ptr = 0x55556ac381c0
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc7c000000, map_A_ptr = 0x55556ac38640
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc7c000000, map_A_ptr = 0x555561774100
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc7c000000, map_A_ptr = 0x55556ac38640
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc7c000000, map_A_ptr = 0x555561774100
TMA Debug: Using RANK=2 for L=1
TMA Debug: dims = [M=7168, K_packed=8192], box = [128, 64]
TMA Encode A Result: 1
TMA Encode A failed: invalid argument
TMA Debug: A_ptr = 0x7ffc7c000000, map_A_ptr = 0x55556ac3864TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
Program stdout (7/9):
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
Program stdout (8/9):
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
Program stdout (9/9):
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
TMA Debug (Python): a_bytes shape=torch.Size([1, 7168, 8192]), stride=(58720256, 8192, 1)
[...] 2413 lines omitted

<<<END OF GEM OUTPUT>>>
